{%extends "base.html" %}
{%block title%} Organizations Â· EventSync{% endblock %}

{% block content %}
<h1>Organizations</h1>

{% if err %}
<p class="error">Error loading organiations: {{err}}</p>
{%endif%}

<h2>Add a new organization</h2>
<form method="post" action="{{url_for('add_organization')}}">
    <label for="org_name">Organization name</label>
    <input id="org_name" name="org_name" type="text" required>

    <label>Venue*</label>
    <select name="vid">
      <option value="" disabled selected>Select a venue</option>
      {% for vid, vlabel in venues %}
        <option value="{{ vid }}">{{ vlabel }}</option>
      {% endfor %}
    </select>
    <button type="submit">Add organization</button>

</form>

<h2 style="margin-top: 24px;">Existing organiations</h2>

{% if venues_with_orgs %}
<ul>
    {% for org in venues_with_orgs %}
    <li style="margin-bottom:6px;">
        {{ org[0] }} {% if org[2] %} - {{org[2]}} {%endif%}
        <form method="post"
            action="{{ url_for('join_organization', org_name=org[0]) }}" 
            style="display:inline"
            onsubmit="return confirm('Join {{ org[0] }}?');">
            
            <button type="submit"
                    {% if name in joined_orgs %}disabled{% endif %}>
                {% if org[0] in joined_orgs %}
                    Joined
                {% else %}
                    Join
                {% endif %}    
                </button>
        </form>
    </li>
    {% endfor %}
</ul>
{% else %}
<p class="muted">No organizations yet. Add one above!</p>
{% endif %}

<p style="margin-top:12px;">
    <a class="btn" href="{{ url_for('home') }}">Back</a>
</p>
{% endblock %}