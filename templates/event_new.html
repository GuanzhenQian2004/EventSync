{% extends "base.html" %}
{% block title %}New Event Â· EventSync{% endblock %}
{% block content %}
  <h1>Create a New Event</h1>

  {% if err %}
    <p class="error">Error loading form options: {{ err }}</p>
  {% endif %}

  <form method="post" class="form">

    <label>Event Name*</label>
    <input name="event_name" type="text" required>

    <label>Organization*</label>
    <select name="org_name" required>
      <option value="" disabled selected>Select an organization</option>
      {% for o in organizations %}
        <option value="{{ o }}">{{ o }}</option>
      {% endfor %}
    </select>

    <label>Venue*</label>
    <select name="vid" required>
      <option value="" disabled selected>Select a venue</option>
      {% for vid, vlabel in venues %}
        <option value="{{ vid }}">{{ vlabel }}</option>
      {% endfor %}
    </select>

    <label>Room # (optional)</label>
    <input name="room_number" type="number" min="0" step="1">

    <label>Date* (YYYY-MM-DD)</label>
    <input name="date" type="date" required>

    <label>Start Time* (HH:MM)</label>
    <input name="start_time" type="time" required>

    <label>End Time* (HH:MM)</label>
    <input name="end_time" type="time" required>

    <label>Price (0 = free)</label>
    <input name="price" type="number" min="0" step="0.01" value="0">

    <label>Description</label>
    <textarea name="description" rows="4" placeholder="Add details..."></textarea>

    <div id="sponsor_container">
      <button type="button" id='sponsor_btn'>Add Corporate Sponsor</button>
    </div>

    <button type="submit">Create Event</button>
  </form>

  <script>
    (function(){
      const container = document.getElementById("sponsor_container")
      const sponsor_button = document.getElementById('sponsor_btn')
      function addNewSponsor(){
        const wrapper = document.createElement('div')
        wrapper.style.display = 'flex'
        wrapper.style.gap = '10px'
        wrapper.style.marginTop='8px'
        const company_input_label = document.createElement('label')
        company_input_label.textContent = "Company"
        const company_input = document.createElement('input')
        company_input.type = 'text'
        company_input.name ='company[]'
        const amt_input_label = document.createElement('label')
        amt_input_label.textContent = 'Amount'
        const amt_input = document.createElement('input')
        amt_input.type = 'text'
        amt_input.name = 'amount[]'
        wrapper.appendChild(company_input_label)
        wrapper.appendChild(company_input)
        wrapper.appendChild(amt_input_label)
        wrapper.appendChild(amt_input)
        return wrapper
      }

      sponsor_button.addEventListener('click',function(){
        const newSec = addNewSponsor()
        container.appendChild(newSec)
      })
      
    })();
  </script>

  <p style="margin-top:12px;">
    <a class="btn" href="{{ url_for('home') }}">Back</a>
  </p>

{% endblock %}
